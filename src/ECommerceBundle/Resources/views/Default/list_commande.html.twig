{% extends "back/index.html.twig" %}

{% block body %}
<link rel="stylesheet" type="text/css" href="{{ asset("back/fahd/cs-skin-elastic.css") }}">
<link rel="stylesheet" type="text/css" href="{{ asset("back/fahd/style.css") }}">
<link rel="stylesheet" type="text/css" href="{{ asset("back/fahd/AfficherProduitCss.css") }}">
<script src="{{ asset('jquery.js') }}"></script>

<div class="content" >
    <form name="product_catalog_list" id="product_catalog_list" method="post" > <!-- action="supprimerProduit.php" -->
        <div class="row">
            <div class="col-md-12">
                <input type="hidden" name="filter_category" value="">
            </div>
        </div>

        <div class="row">

            <!--<div class="col-md-12">--> <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">



                <div class="card">
                    <h7 class="card-header" style="font-weight : bolder">Liste des Commandes</h7> <!-- font weight-->
                    <div class="card-body"  id="employee_table"> <!-- class="table-responsive" -->
                        <table class="table product mt-3" redirecturl="" >
                            <thead class="with-filters">
                            <tr class="column-headers">
                                <th scope="col" style="width: 2rem"></th>

                                <th scope="col" style="width: 5rem" >
                                    <!--<div class="ps-sortable-column" data-sort-is-current="true" data-sort-direction="desc">-->
                                    <div class="ps-sortable-column" data-sort-col-name="name" >
                                        <a class="column_sort" id="id" data-order="desc" href="#">ID</a>
                                        <span role="button" class="ps-sort" aria-label="Tri" ></span>

                                    </div>
                                </th>


                                <th scope="col">
                                </th>
                                <th scope="col" class="text-center" style="width: 11rem" >
                                    <div class="ps-sortable-column " data-sort-col-name="name"   >
                                        <a class="column_sort" id="nom_client" data-order="desc" href="#">Username</a>
                                        <span role="button" class="ps-sort" aria-label="Tri"></span>
                                    </div>
                                </th>


                                <th scope="col" class="text-center" >
                                    <div  data-sort-col-name="name"  >
                                        <span role="columnheader" style="padding-left: 15%">E-mail</span>
                                    </div>
                                </th>


                                <th scope="col" class="text-center" >
                                    <div  data-sort-col-name="name">
                                        <span role="columnheader">Type de Paiment</span>
                                        <!--<span role="button" class="ps-sort" aria-label="Tri"></span>-->
                                    </div>
                                    <!-- <div class="ps-sortable-column" data-sort-col-name="name" >
                                         <a class="column_sort" id="categorie" data-order="desc" href="#">Paiment</a>
                                         <span role="button" class="ps-sort" aria-label="Tri"></span>
                                     </div>-->
                                </th>


                                <th scope="col" class="text-center" style="width: 20%">
                                    <div  data-sort-col-name="name">
                                        <span role="columnheader">Etat</span>
                                        <!--<span role="button" class="ps-sort" aria-label="Tri"></span>-->
                                    </div>
                                    <!--<div class="ps-sortable-column" data-sort-col-name="name" >
                                        <a class="column_sort" id="quantite" data-order="desc" href="#">Etat</a>
                                        <span role="button" class="ps-sort" aria-label="Tri"></span>
                                    </div>-->
                                </th>

                                <th scope="col" class="text-center" style="width: 0%">
                                    <div class="ps-sortable-column" data-sort-col-name="name" >{#
                                        <a class="column_sort" id="prix_total" data-order="desc" href="#"></a>
                                        <span role="button" class="ps-sort" aria-label="Tri"></span>#}
                                    </div>
                                </th>


                                <th scope="col" class="text-center" style="width: 9%">
                                    <div class="ps-sortable-column" data-sort-col-name="name" >
                                        <a class="column_sort" id="date" data-order="desc" href="#">Date</a>
                                        <span role="button" class="ps-sort" aria-label="Tri"></span>
                                    </div>
                                </th>

                                <th scope="col" class="text-center">
                                    <span role="columnheader">Facture</span>
                                </th>

                                <th scope="col" class="text-right" style="width: 3rem; padding-right: 2rem">
                                    Actions
                                </th>
                            </tr>

                            <tr class="column-filters">
                                <th colspan="2">
                                    <!--<div id="filter_column_id_product_div">
                                        <input type="hidden" id="filter_column_id_product" name="filter_column_id_product" value="" sql="">
                                        <input class="form-control" type="text" id="id_product" value="" placeholder="Chercher ID" style="font-size: 13px" onkeydown="onkd()" >-->
                                    <!--<input class="form-control form-min-max" type="text" id="filter_column_id_product_max" value="" placeholder="Max">-->
                                    <!-- </div>-->
                                </th>
                                <th><!--&nbsp;--></th>
                                <th>
                                    <!--  <input type="text" class="form-control" placeholder="Chercher un nom" id="noms" name="filter_column_name" value="" onkeydown="onkd()" >-->
                                </th>
                                <th>
                                    <!-- <input type="text" class="form-control" placeholder="Chercher réf." id="refs" name="filter_column_reference" value="" onkeydown="onkd()">
                                 --></th>
                                <th>
                                    <!--<input type="text" class="form-control" placeholder="Chercher une catégorie" name="filter_column_name_category" value="">-->
                                    <!-- <select required="" data-parsley-length="[5,10]" placeholder="" class="form-control" id="id_categories" onchange="" onkeydown="onkd()">
                                         <option value="" disabled selected>Type paiment</option>
                                         <option value="Cheque">Cheque</option>
                                         <option value="espece">espece</option>
                                         <option value="virement bancaire">virement bancaire</option>
                                     </select>-->
                                </th>
                                <th class="text-center">
                                    <!-- <div id="quantites">
                                         <input type="hidden" id="filter_column_price" name="filter_column_price" >
                                         <select required="" data-parsley-length="[5,10]" placeholder="" class="form-control" id="id_categories" onchange="" onkeydown="onkd()">
                                             <option value="" disabled selected>Etat</option>
                                             <option value="Cheque">Annule</option>
                                             <option value="espece">En attente de virement banquaire</option>
                                             <option value="virement bancaire">En cours de préparation</option>
                                             <option value="virement bancaire">Erreur de paiment</option>
                                             <option value="virement bancaire">Livré</option>
                                             <option value="virement bancaire">Paiment accepté</option>
                                         </select>
                                     </div>-->
                                </th>
                                <th class="text-center">
                                    <!--<div id="montants">
                                         <input type="hidden" id="filter_column_price" name="filter_column_price" >
                                         <input class="form-control form-min-max" type="text" id="montant_min" value="" placeholder="Min.">
                                         <input class="form-control form-min-max" type="text" id="montant_max" value="" placeholder="Max.">
                                     </div>-->
                                </th>

                                <th id="product_filter_column_active" class="text-center">
                                    <!-- <div class="form-select">
                                         <select class="custom-select" name="filter_column_active">
                                             <option value=""></option>
                                             <option value="1">Active</option>
                                             <option value="0">Inactive</option>
                                         </select>
                                     </div>-->
                                </th>
                                <th id="product_filter_column_active" class="text-center">
                                    <!-- <div class="form-select">
                                         <select class="custom-select" name="filter_column_active">
                                             <option value=""></option>
                                             <option value="1">Active</option>
                                             <option value="0">Inactive</option>
                                         </select>
                                     </div>-->
                                </th>
                                <th class="text-right" style="width: 5rem">
                                    <!-- submit -->
                                    <!-- <button type="button" class="btn btn-primary" name="products_filter_submit" title="Rechercher" id="searsh">
                                         <i class="" style="position: absolute"></i>
                                         Rechercher
                                     </button>
                                     <input type="hidden" name="Reins">-->
                                </th>
                                <!--<th>
                                    <button type="reset" class="btn btn-link" name="products_filter_reset" onclick="productColumnFilterReset($(this).closest('tr.column-filters'))" title="Réinitialiser" style="display: none;">
                                        <i class="material-icons">clear</i>
                                        Réinitialiser
                                    </button>
                                </th>-->
                            </tr>
                            <!-- LGINHE 1 -->
                            {% for cmds in cmds %}

                            <tr data-product-id="1"><!--data-uniturl="/prestashop_1.7.5.0/admin574ttpvee/index.php/sell/catalog/products/unit/duplicate/19?_token=A2IC3bxCDtcD56ZtVFZxBESqGejkhhh8W-wzhuG3Ijo"-->
                                <td class="checkbox-column form-group">
                                    <div class="md-checkbox md-checkbox-inline">

                                    </div>
                                </td>

                                <td>
                                    <label class="form-check-label" for="bulk_action_selected_products-19">
                                        {{ cmds.commande_id }}
                                    </label>
                                </td>
                                <td class="text-center" id ="" >
                                    <input type="hidden" id="" value="" >
                                </td>

                                <td class="text-center">

                                        {% for client in clients %}
                                            {% if client.id == cmds.user_id %}
                                                {{ client.username }}
                                            {% endif %}
                                        {% endfor %}

                                </td>

                                <td class="text-center">
                                    &emsp;&emsp;&emsp;  {% for client in clients %}
                                        {% if client.id == cmds.user_id %}
                                            {{ client.email }}
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td class="text-center">
                                    {% for commande in commandes %}
                                        {% if commande.id == cmds.commande_id %}
                                            {{ commande.paiment }}
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td class="text-center">
                                    {% for commande in commandes %}
                                        {% if commande.id == cmds.commande_id %}
                                            {{ commande.etat }}
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td class="text-center">

                                </td>

                                <td class="product-sav-quantity text-center" >
                                    {% for commande in commandes %}
                                        {% if commande.id == cmds.commande_id %}
                                            {{ commande.date | date('Y-m-d') }}
                                        {% endif %}
                                    {% endfor %}
                                </td>
                                <td class="text-center">
                                    {% for client in clients %}
                                        {% if client.id == cmds.user_id %}
                                            {#<a href="{{ path('modify_commande',{'id_commande':cmds.commande_id,'clientid':client.id}) }}"  title="" class="btn tooltip-link product-edit">#}
                                            <a  target="_blank" href="{{ asset('FacturePdf/'~cmds.commande_id~'_'~client.id~'.pdf') }}" title="" class="btn tooltip-link product-edit">
                                                <i class="material-icons">picture_as_pdf</i>
                                            </a>
                                        {% endif %}
                                    {% endfor %}
                                </td>

                                <td class="text-right">
                                    <div class="btn-group-action">
                                        <div class="btn-group">

                                            {% for client in clients %}
                                                {% if client.id == cmds.user_id %}
                                            <a href="{{ path('modify_commande',{'id_commande':cmds.commande_id,'clientid':client.id}) }}"  title="" class="btn tooltip-link product-edit">
                                            {% endif %}
                                            {% endfor %}

                                                <i class="material-icons">mode_edit</i>
                                            </a>
                                            <a  href="{{ path('delete_commande',{'id_commande':cmds.commande_id}) }}" onclick="return confirm('Voulez vous supprimer la commande ?');" title="" class="btn tooltip-link product-edit">
                                                <i class="material-icons action-enabled">clear</i></a>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}

                            </thead>
                        </table>
                        {# </div>
                     </div>#}

                    </div>
                        <!-- !CADRE -->

                        </form>
                    </div>

    <script>
        $(document).ready(function(){

            $(document).on('click', '.column_sort', function(){
                //alert('azeaze');
                if  (document.getElementById('id_query')){var query = document.getElementById('id_query').value ;}

                var column_name = $(this).attr("id");
                var order = $(this).data("order");
                var arrow = '';
                var arrowe ='<span role="button" class="ps-sort" aria-label="Tri">';

                if(order == 'desc')
                {
                    //  arrow = '&nbsp;<span class="glyphicon glyphicon-arrow-down"></span>';
                    arrow = '<div class="ps-sortable-column" data-sort-is-current="true" data-sort-direction="desc"><span role="button" class="ps-sort" aria-label="Tri" ></span>';
                }
                else
                {
                    arrow = '<div class="ps-sortable-column" data-sort-is-current="true" data-sort-direction="asc"><span  role="button" class="ps-sort" aria-label="Tri" >';
                }

                $.ajax({
                    url:"{{ path('Sort_commande') }}",
                    method:"POST",
                    data:{column_name:column_name, order:order,query:query},
                    success:function(data)
                    {
                        // $('#1234').append('<div >fahd</div>');
                        $('#employee_table').html(data);
                        $('#'+column_name+'').append(arrow);
                        var ids = ["id","nom_client","prix_total","date"];
                        var i = 0;
                        for (;ids[i];) {
                            if (ids[i] != column_name)
                                $('#'+ids[i]+'').append(arrowe);
                            i++;
                        }
                    }
                })
            });
        });

    </script>

{% endblock %}


